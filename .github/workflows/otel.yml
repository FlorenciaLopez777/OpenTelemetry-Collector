- name: Wait for Collector health (up to 30s)
  run: |
    for i in {1..30}; do
      docker logs otelcol --since 1s || true
      if docker logs otelcol 2>&1 | grep -qi "Everything is ready"; then
        echo "Collector ready."
        exit 0
      fi
      if docker logs otelcol 2>&1 | grep -qi "Starting GRPC server"; then
        echo "Collector GRPC server started."
        exit 0
      fi
      sleep 1
    done
    echo "Collector did not become ready in time."
    docker logs otelcol
    exit 1
